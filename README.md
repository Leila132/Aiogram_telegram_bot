# Aiogram_telegram_bot

telegram-бот, который позволяет пользователям загружать Excel-файлы с данными для парсинга (URL, XPath-запросы). Бот вычисляет среднюю стоимость товаров и выводит результаты в удобном формате.

# Основной функционал:
- Загрузка данных через Excel – пользователи отправляют .xlsx-файл со списком товаров (название, URL, XPath для цены).
- Парсинг цен – бот анализирует HTML-страницы, извлекает цены по заданным XPath-селекторам.
- Расчет средней цены – автоматически вычисляет среднюю стоимость по всем корректно обработанным товарам.
- Управление записями – просмотр всех загруженных данных.
- Логирование  – все действия фиксируются в логах.

# Технологии и инструменты:
## Backend:

Python (+ asyncio для асинхронной работы)

SQLAlchemy (ORM) + aiosqlite (асинхронная SQLite)

Aiogram (фреймворк для Telegram-ботов)

lxml + requests (парсинг HTML)

pandas (обработка Excel-файлов)

pydantic (валидация данных)

logging (логирование действий)

## База данных:

SQLite 

# Архитектура проекта:
Проект построен по многослойной архитектуре с разделением на:

Репозитории (UserRepository, QueryRepository, StatusRepository) – работа с БД.

Сервисы (UserService, QueryService, HtmlAgentService) – бизнес-логика.

Telegram-бот (bot.py) – обработка команд и взаимодействие с пользователем.

Валидация данных (schemas.py) – проверка URL, XPath и структуры файлов.

## Установка

1. Клонируйте репозиторий:
```
git clone https://github.com/Leila132/Aiogram_telegram_bot.git
```
2. Перейдите в директорию проекта:
```
cd Aiogram_telegram_bot
```
3. Установите зависимости:
```
pip install -r requirements.txt
```
4. Создайте файл с переменными окружения:
```
touch .env
```
Содержимое файла:
```
API_TOKEN = "token_from_telegram"
```
